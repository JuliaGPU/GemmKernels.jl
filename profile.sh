#!/usr/bin/env bash
set -Eeuo pipefail

rm -f prof*.ncu-rep

for TC in "1.2.3.4.5.6-5.6.7.3-7.4.1.2" "1.2.3.4.5.6-7.6.2.3-4.5.7.1" "1.2.3.4.5.6-7.6.1.3-4.5.7.2" "1.2.3.4.5.6-7.6.1.2-4.5.7.3" "1.2.3.4.5.6-7.5.2.3-4.6.7.1" "1.2.3.4.5.6-7.5.1.3-4.6.7.2" "1.2.3.4.5.6-7.5.1.2-4.6.7.3" "1.2.3.4.5.6-7.4.2.3-5.6.7.1" "1.2.3.4.5.6-7.4.1.3-5.6.7.2" "1.2.3.4.5.6-7.4.1.2-5.6.7.3" "1.2.3.4.5.6-5.6.7.2-7.4.1.3" "1.2.3.4.5.6-5.6.7.1-7.4.2.3" "1.2.3.4.5.6-4.6.7.3-7.5.1.2" "1.2.3.4.5.6-4.6.7.2-7.5.1.3" "1.2.3.4.5.6-4.6.7.1-7.5.2.3" "1.2.3.4.5.6-4.5.7.3-7.6.1.2" "1.2.3.4.5.6-4.5.7.2-7.6.1.3" "1.2.3.4.5.6-4.5.7.1-7.6.2.3" "1.2.3.4-5.1.6.3-2.6.4.5" "1.2.3.4-1.5.6.3-6.2.5.4" "1.2.3.4-1.5.6.2-6.4.3.5" "1.2.3.4-1.5.4.6-6.2.5.3" "1.2.3.4-1.5.4.6-2.6.3.5" "1.2.3.4-1.5.3.6-6.2.5.4" "1.2.3.4-1.5.3.6-2.6.4.5" "1.2.3.4-1.5.2.6-6.4.5.3" "1.2.3.4-1.5.2.6-4.6.3.5" "1.2.3-1.4.5.3-5.2.4" "1.2.3-1.4.3-4.2" "1.2.3-1.4.3-2.4" "1.2.3-1.4-2.4.3" "1.2.3-1.3.4-4.2" "1.2-1.3.4-4.2.3" "1.2-1.3-3.2" "1.2.3.4-5.3-1.2.5.4" "1.2.3.4-5.2-1.5.3.4" "1.2.3.4-5.1-5.2.3.4" "1.2.3.4.5-5.6.3.1.4-2.6" "1.2.3.4.5-5.3.2.6.1-6.4" "1.2.3.4.5-5.6.2.1.4-3.6" "1.2.3.4-5.2.1.4-3.5" "1.2.3.4-4.5.3.1-2.5" "1.2.3.4-4.2.5.1-5.3" "1.2.3-4.3.1-2.4" "1.2.3-2.4.1-4.3" "1.2.3.4-5.1.6.4-6.2.5.3" "1.2.3.4-5.1.6.2-6.4.5.3" "1.2-3.1.4-4.3.2"; do
    for impl in cutensor gemmkernels-optimal-for-jupiter gemmkernels-optimal-for-ripper; do
        /usr/local/cuda-12.4/bin/ncu --set full -f --profile-from-start off -o prof-host-$(hostname)-tc-$TC-impl-$impl julia --project=tuning ./profile.jl $TC $impl
    done
done
